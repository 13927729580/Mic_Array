###############################################################################
#
# IAR ANSI C/C++ Compiler V7.50.2.10312/W32 for ARM       07/Mar/2016  01:52:04
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Drivers\STM32F7xx_HAL_Driver\Src\stm32f7xx_hal_i2c_ex.c
#    Command line =  
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Drivers\STM32F7xx_HAL_Driver\Src\stm32f7xx_hal_i2c_ex.c
#        -D USE_HAL_DRIVER -D STM32F746xx -D USE_STM32746G_DISCO -D
#        USE_IOEXPANDER -D USE_USB_FS -lC
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\STM32F7\List
#        -lA
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\STM32F7\List
#        -o
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\STM32F7\Obj
#        --no_unroll --debug --endian=little --cpu=Cortex-M7 -e --fpu=VFPv5_sp
#        --dlib_config "D:\Program Files (x86)\IAR Systems\Embedded Workbench
#        7.3\arm\INC\c\DLib_Config_Full.h" -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\Inc\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Drivers\CMSIS\Device\ST\STM32F7xx\Include\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Drivers\STM32F7xx_HAL_Driver\Inc\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Drivers\BSP\STM32746G-Discovery\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Drivers\BSP\Components\Common\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Utilities\Log\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Utilities\Fonts\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Utilities\CPU\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Middlewares\ST\STM32_USB_Device_Library\Core\Inc\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Middlewares\ST\STM32_USB_HOST_Library\Core\Inc\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Middlewares\ST\STM32_USB_HOST_Library\Class\MSC\Inc\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Middlewares\Third_Party\FatFs\src\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Middlewares\Third_Party\FatFs\src\drivers\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Middlewares\ST\STM32_Audio\Addons\PDM\
#        -I
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\..\..\..\..\..\..\Middlewares\ST\STM32_USB_Device_Library\Class\AUDIO\Inc\
#        -Oh --use_c++_inline --require_prototypes -I "D:\Program Files
#        (x86)\IAR Systems\Embedded Workbench 7.3\arm\CMSIS\Include\" -D
#        ARM_MATH_CM7 --relaxed_fp
#    List file    =  
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\STM32F7\List\stm32f7xx_hal_i2c_ex.lst
#    Object file  =  
#        H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Projects\STM32746G\Applications\Audio\Mic_Array\EWARM\STM32F7\Obj\stm32f7xx_hal_i2c_ex.o
#
###############################################################################

H:\PhanLeSon\ActivNoise\Microphone\F7\Mic_Array_Project\Mic_Array\Drivers\STM32F7xx_HAL_Driver\Src\stm32f7xx_hal_i2c_ex.c
      1          /**
      2            ******************************************************************************
      3            * @file    stm32f7xx_hal_i2c_ex.c
      4            * @author  MCD Application Team
      5            * @version V1.0.1
      6            * @date    25-June-2015
      7            * @brief   I2C Extended HAL module driver.
      8            *          This file provides firmware functions to manage the following 
      9            *          functionalities of I2C Extended peripheral:
     10            *           + Extended features functions
     11            *         
     12            @verbatim
     13            ==============================================================================
     14                         ##### I2C peripheral Extended features  #####
     15            ==============================================================================
     16                     
     17            [..] Comparing to other previous devices, the I2C interface for STM32L4XX
     18                 devices contains the following additional features
     19                 
     20                 (+) Possibility to disable or enable Analog Noise Filter
     21                 (+) Use of a configured Digital Noise Filter
     22                 (+) Disable or enable wakeup from Stop mode
     23             
     24                               ##### How to use this driver #####
     25            ==============================================================================
     26            [..] This driver provides functions to:
     27              (#) Configure I2C Analog noise filter using the function HAL_I2CEx_ConfigAnalogFilter()
     28              (#) Configure I2C Digital noise filter using the function HAL_I2CEx_ConfigDigitalFilter()
     29            @endverbatim
     30            ******************************************************************************
     31            * @attention
     32            *
     33            * <h2><center>&copy; COPYRIGHT(c) 2015 STMicroelectronics</center></h2>
     34            *
     35            * Redistribution and use in source and binary forms, with or without modification,
     36            * are permitted provided that the following conditions are met:
     37            *   1. Redistributions of source code must retain the above copyright notice,
     38            *      this list of conditions and the following disclaimer.
     39            *   2. Redistributions in binary form must reproduce the above copyright notice,
     40            *      this list of conditions and the following disclaimer in the documentation
     41            *      and/or other materials provided with the distribution.
     42            *   3. Neither the name of STMicroelectronics nor the names of its contributors
     43            *      may be used to endorse or promote products derived from this software
     44            *      without specific prior written permission.
     45            *
     46            * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
     47            * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
     48            * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
     49            * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
     50            * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
     51            * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
     52            * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
     53            * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
     54            * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
     55            * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
     56            *
     57            ******************************************************************************  
     58            */ 
     59          
     60          /* Includes ------------------------------------------------------------------*/
     61          #include "stm32f7xx_hal.h"
     62          
     63          /** @addtogroup STM32F7xx_HAL_Driver
     64            * @{
     65            */
     66          
     67          /** @defgroup I2CEx I2C Extended HAL module driver
     68            * @brief I2C Extended HAL module driver
     69            * @{
     70            */
     71          
     72          #ifdef HAL_I2C_MODULE_ENABLED
     73          
     74          /* Private typedef -----------------------------------------------------------*/
     75          /* Private define ------------------------------------------------------------*/
     76          /* Private macro -------------------------------------------------------------*/
     77          /* Private variables ---------------------------------------------------------*/
     78          /* Private function prototypes -----------------------------------------------*/
     79          /* Private functions ---------------------------------------------------------*/
     80          
     81          /** @defgroup I2CEx_Exported_Functions I2C Extended Exported Functions
     82            * @{
     83            */
     84          
     85          /** @defgroup I2CEx_Exported_Functions_Group1 Extended features functions
     86            * @brief    Extended features functions
     87           *
     88          @verbatim   
     89           ===============================================================================
     90                                ##### Extended features functions #####
     91           ===============================================================================  
     92              [..] This section provides functions allowing to:
     93                (+) Configure Noise Filters 
     94          
     95          @endverbatim
     96            * @{
     97            */
     98            
     99          /**
    100            * @brief  Configures I2C Analog noise filter. 
    101            * @param  hi2c : pointer to a I2C_HandleTypeDef structure that contains
    102            *                the configuration information for the specified I2Cx peripheral.
    103            * @param  AnalogFilter : new state of the Analog filter.
    104            * @retval HAL status
    105            */

   \                                 In section .text, align 2, keep-with-next
    106          HAL_StatusTypeDef HAL_I2CEx_ConfigAnalogFilter(I2C_HandleTypeDef *hi2c, uint32_t AnalogFilter)
    107          {
    108            /* Check the parameters */
    109            assert_param(IS_I2C_ALL_INSTANCE(hi2c->Instance));
    110            assert_param(IS_I2C_ANALOG_FILTER(AnalogFilter));
    111            
    112            if((hi2c->State == HAL_I2C_STATE_BUSY) || (hi2c->State == HAL_I2C_STATE_MASTER_BUSY_TX) || (hi2c->State == HAL_I2C_STATE_MASTER_BUSY_RX)
    113               || (hi2c->State == HAL_I2C_STATE_SLAVE_BUSY_TX) || (hi2c->State == HAL_I2C_STATE_SLAVE_BUSY_RX))
   \                     HAL_I2CEx_ConfigAnalogFilter: (+1)
   \   00000000   0xF100 0x0234      ADD      R2,R0,#+52
   \   00000004   0xB410             PUSH     {R4}
   \   00000006   0x7853             LDRB     R3,[R2, #+1]
   \   00000008   0x2B02             CMP      R3,#+2
   \   0000000A   0xBF1C             ITT      NE 
   \   0000000C   0x7853             LDRBNE   R3,[R2, #+1]
   \   0000000E   0x2B12             CMPNE    R3,#+18
   \   00000010   0xD00B             BEQ.N    ??HAL_I2CEx_ConfigAnalogFilter_0
   \   00000012   0x7853             LDRB     R3,[R2, #+1]
   \   00000014   0x2B22             CMP      R3,#+34
   \   00000016   0xBF1C             ITT      NE 
   \   00000018   0x7853             LDRBNE   R3,[R2, #+1]
   \   0000001A   0x2B32             CMPNE    R3,#+50
   \   0000001C   0xD005             BEQ.N    ??HAL_I2CEx_ConfigAnalogFilter_0
   \   0000001E   0x7853             LDRB     R3,[R2, #+1]
   \   00000020   0x2B42             CMP      R3,#+66
   \   00000022   0xBF1C             ITT      NE 
   \   00000024   0x7813             LDRBNE   R3,[R2, #+0]
   \   00000026   0x2B01             CMPNE    R3,#+1
    114            {
    115              return HAL_BUSY;
    116            }
    117            
    118            /* Process Locked */
    119            __HAL_LOCK(hi2c);
   \   00000028   0xD100             BNE.N    ??HAL_I2CEx_ConfigAnalogFilter_1
   \                     ??HAL_I2CEx_ConfigAnalogFilter_0: (+1)
   \   0000002A   0x....             B.N      ?Subroutine1
   \                     ??HAL_I2CEx_ConfigAnalogFilter_1: (+1)
   \   0000002C   0x2301             MOVS     R3,#+1
   \   0000002E   0x7013             STRB     R3,[R2, #+0]
    120          
    121            hi2c->State = HAL_I2C_STATE_BUSY;
   \   00000030   0x2302             MOVS     R3,#+2
   \   00000032   0x7053             STRB     R3,[R2, #+1]
    122            
    123            /* Disable the selected I2C peripheral */
    124            __HAL_I2C_DISABLE(hi2c);    
   \   00000034   0x6803             LDR      R3,[R0, #+0]
   \   00000036   0x681C             LDR      R4,[R3, #+0]
   \   00000038   0x0864             LSRS     R4,R4,#+1
   \   0000003A   0x0064             LSLS     R4,R4,#+1
   \   0000003C   0x601C             STR      R4,[R3, #+0]
    125            
    126            /* Reset I2Cx ANOFF bit */
    127            hi2c->Instance->CR1 &= ~(I2C_CR1_ANFOFF);    
   \   0000003E   0x6803             LDR      R3,[R0, #+0]
   \   00000040   0x681C             LDR      R4,[R3, #+0]
   \   00000042   0xF424 0x5480      BIC      R4,R4,#0x1000
   \   00000046   0x601C             STR      R4,[R3, #+0]
    128            
    129            /* Set analog filter bit*/
    130            hi2c->Instance->CR1 |= AnalogFilter;
   \   00000048   0x6803             LDR      R3,[R0, #+0]
   \   0000004A   0x681C             LDR      R4,[R3, #+0]
   \   0000004C   0x4321             ORRS     R1,R1,R4
   \   0000004E   0x....             B.N      ?Subroutine0
    131            
    132            __HAL_I2C_ENABLE(hi2c); 
    133            
    134            hi2c->State = HAL_I2C_STATE_READY;
    135            
    136            /* Process Unlocked */
    137            __HAL_UNLOCK(hi2c);
    138          
    139            return HAL_OK; 
    140          }

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine1: (+1)
   \   00000000   0x2002             MOVS     R0,#+2
   \   00000002   0xBC10             POP      {R4}
   \   00000004   0x4770             BX       LR

   \                                 In section .text, align 2, keep-with-next
   \                     ?Subroutine0: (+1)
   \   00000000   0x6019             STR      R1,[R3, #+0]
   \   00000002   0x6800             LDR      R0,[R0, #+0]
   \   00000004   0x6801             LDR      R1,[R0, #+0]
   \   00000006   0xF041 0x0101      ORR      R1,R1,#0x1
   \   0000000A   0x6001             STR      R1,[R0, #+0]
   \   0000000C   0x2001             MOVS     R0,#+1
   \   0000000E   0x7050             STRB     R0,[R2, #+1]
   \   00000010   0x2000             MOVS     R0,#+0
   \   00000012   0x7010             STRB     R0,[R2, #+0]
   \   00000014   0xBC10             POP      {R4}
   \   00000016   0x4770             BX       LR               ;; return
    141          
    142          /**
    143            * @brief  Configures I2C Digital noise filter. 
    144            * @param  hi2c : pointer to a I2C_HandleTypeDef structure that contains
    145            *                the configuration information for the specified I2Cx peripheral.
    146            * @param  DigitalFilter : Coefficient of digital noise filter between 0x00 and 0x0F.
    147            * @retval HAL status
    148            */

   \                                 In section .text, align 2, keep-with-next
    149          HAL_StatusTypeDef HAL_I2CEx_ConfigDigitalFilter(I2C_HandleTypeDef *hi2c, uint32_t DigitalFilter)
    150          {
    151            uint32_t tmpreg = 0;
    152            
    153            /* Check the parameters */
    154            assert_param(IS_I2C_ALL_INSTANCE(hi2c->Instance));
    155            assert_param(IS_I2C_DIGITAL_FILTER(DigitalFilter));
    156            
    157            if((hi2c->State == HAL_I2C_STATE_BUSY) || (hi2c->State == HAL_I2C_STATE_MASTER_BUSY_TX) || (hi2c->State == HAL_I2C_STATE_MASTER_BUSY_RX)
    158               || (hi2c->State == HAL_I2C_STATE_SLAVE_BUSY_TX) || (hi2c->State == HAL_I2C_STATE_SLAVE_BUSY_RX))
   \                     HAL_I2CEx_ConfigDigitalFilter: (+1)
   \   00000000   0xF100 0x0234      ADD      R2,R0,#+52
   \   00000004   0xB410             PUSH     {R4}
   \   00000006   0x7853             LDRB     R3,[R2, #+1]
   \   00000008   0x2B02             CMP      R3,#+2
   \   0000000A   0xBF1C             ITT      NE 
   \   0000000C   0x7853             LDRBNE   R3,[R2, #+1]
   \   0000000E   0x2B12             CMPNE    R3,#+18
   \   00000010   0xD00B             BEQ.N    ??HAL_I2CEx_ConfigDigitalFilter_0
   \   00000012   0x7853             LDRB     R3,[R2, #+1]
   \   00000014   0x2B22             CMP      R3,#+34
   \   00000016   0xBF1C             ITT      NE 
   \   00000018   0x7853             LDRBNE   R3,[R2, #+1]
   \   0000001A   0x2B32             CMPNE    R3,#+50
   \   0000001C   0xD005             BEQ.N    ??HAL_I2CEx_ConfigDigitalFilter_0
   \   0000001E   0x7853             LDRB     R3,[R2, #+1]
   \   00000020   0x2B42             CMP      R3,#+66
   \   00000022   0xBF1C             ITT      NE 
   \   00000024   0x7813             LDRBNE   R3,[R2, #+0]
   \   00000026   0x2B01             CMPNE    R3,#+1
    159            {
    160              return HAL_BUSY;
    161            }
    162            
    163            /* Process Locked */
    164            __HAL_LOCK(hi2c);
   \   00000028   0xD100             BNE.N    ??HAL_I2CEx_ConfigDigitalFilter_1
   \                     ??HAL_I2CEx_ConfigDigitalFilter_0: (+1)
   \   0000002A   0x....             B.N      ?Subroutine1
   \                     ??HAL_I2CEx_ConfigDigitalFilter_1: (+1)
   \   0000002C   0x2301             MOVS     R3,#+1
   \   0000002E   0x7013             STRB     R3,[R2, #+0]
    165          
    166            hi2c->State = HAL_I2C_STATE_BUSY;
   \   00000030   0x2302             MOVS     R3,#+2
   \   00000032   0x7053             STRB     R3,[R2, #+1]
    167            
    168            /* Disable the selected I2C peripheral */
    169            __HAL_I2C_DISABLE(hi2c);  
   \   00000034   0x6803             LDR      R3,[R0, #+0]
   \   00000036   0x681C             LDR      R4,[R3, #+0]
   \   00000038   0x0864             LSRS     R4,R4,#+1
   \   0000003A   0x0064             LSLS     R4,R4,#+1
   \   0000003C   0x601C             STR      R4,[R3, #+0]
    170            
    171            /* Get the old register value */
    172            tmpreg = hi2c->Instance->CR1;
   \   0000003E   0x6803             LDR      R3,[R0, #+0]
   \   00000040   0x681C             LDR      R4,[R3, #+0]
    173            
    174            /* Reset I2Cx DNF bits [11:8] */
    175            tmpreg &= ~(I2C_CR1_DFN);
    176            
    177            /* Set I2Cx DNF coefficient */
    178            tmpreg |= DigitalFilter << 8;
    179            
    180            /* Store the new register value */
    181            hi2c->Instance->CR1 = tmpreg;
   \   00000042   0xF424 0x6470      BIC      R4,R4,#0xF00
   \   00000046   0xEA44 0x2101      ORR      R1,R4,R1, LSL #+8
   \   0000004A   0x....             B.N      ?Subroutine0
    182            
    183            __HAL_I2C_ENABLE(hi2c); 
    184            
    185            hi2c->State = HAL_I2C_STATE_READY;
    186            
    187            /* Process Unlocked */
    188            __HAL_UNLOCK(hi2c);
    189          
    190            return HAL_OK; 
    191          }  
    192          
    193          /**
    194            * @}
    195            */  
    196          
    197          /**
    198            * @}
    199            */  
    200          
    201          #endif /* HAL_I2C_MODULE_ENABLED */
    202          /**
    203            * @}
    204            */
    205          
    206          /**
    207            * @}
    208            */
    209          
    210          /************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       4   HAL_I2CEx_ConfigAnalogFilter
       4   HAL_I2CEx_ConfigDigitalFilter


   Section sizes:

   Bytes  Function/Label
   -----  --------------
      24  ?Subroutine0
       6  ?Subroutine1
      80  HAL_I2CEx_ConfigAnalogFilter
      76  HAL_I2CEx_ConfigDigitalFilter

 
 186 bytes in section .text
 
 186 bytes of CODE memory

Errors: none
Warnings: none
